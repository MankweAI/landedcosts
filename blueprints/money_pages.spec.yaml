# money_pages.spec.yaml
# Source: money_pages.md [file:4]

spec_version: "1.0" # [file:4]
title: "Money Page Contract (Template Spec) — pSEO + SaaS “Win Screen”" # [file:4]

document: # [file:4]
  doc_type: "Implementable template contract (SWE LLM must follow exactly)" # [file:4]
  applies_to: "All SEO money pages (indexable + noindex variants)" # [file:4]
  wedge: "China -> South Africa" # [file:4]
  primary_route: "/import-duty-vat-landed-cost/{clusterSlug}/from/{originIso}/to/{destIso}" # [file:4]
  destination_slug_required: "south-africa" # [file:4]

purpose: # [file:4]
  positioning: "Not an article; a fully usable tool page." # [file:4]
  must_do: # [file:4]
    - "Preload calculator for the page’s product/origin context." # [file:4]
    - "Show computed outputs immediately via SSR." # [file:4]
    - "Include structured blocks that make the page uniquely valuable + index-worthy." # [file:4]
  non_negotiable: # [file:4]
    computed_scenario_presets: # [file:4]
      presets_required: 3 # [file:4]
      preset_examples: ["R10k", "R50k", "R250k"] # [file:4]
      rule: "If cannot compute (missing tariff/rates), page stays NOINDEX." # [file:4]

page_types: # [file:4]
  - id: "cluster_money_page" # [file:4]
    route: "/import-duty-vat-landed-cost/{clusterSlug}/from/{originIso}/to/{destIso}" # [file:4]
    use_when: "User intent is product-category and HS is inferred (e.g., solar panels, lithium batteries)." # [file:4]
  - id: "hs_money_page" # [file:4]
    route_note: "HS-focused route exists and can be a canonical target when mapping is confident." # [file:4]
    use_when: "HS is known or product->HS canonicalization applies." # [file:4]

layout_contract: # [file:4]
  win_screen: # [file:4]
    above_the_fold: # [file:4]
      must_include_in_order: # [file:4]
        - "Breadcrumbs" # [file:4]
        - "H1: Import duty & landed cost for {X} from {Y} -> South Africa" # [file:4]
        - "Subtitle (one sentence orientation)" # [file:4]
        - "CalcCard (minimal inputs + HS helper inline)" # [file:4]
        - "Result Preview + ConfidenceBadge (before user edits inputs)" # [file:4]
      constraint: "This is the win screen spec; do not deviate." # [file:4]

    below_the_fold: # [file:4]
      must_include_blocks_in_order: # [file:4]
        - "Breakdown block with 'Why drawer' per line item (Duty, VAT, fees)" # [file:4]
        - "Scenario presets (3 SSR presets + one-click apply)" # [file:4]
        - "Doc checklist (grouped)" # [file:4]
        - "Preference eligibility (traffic-light; may be 'unknown' initially)" # [file:4]
        - "Risk callouts" # [file:4]
        - "InternalLinkGrid (meaningful related tools/pages)" # [file:4]
        - "Next best actions (context-aware CTAs)" # [file:4]

components_required_shared_inventory: # [file:4]
  - "CalcCard" # [file:4]
  - "BreakdownTable" # [file:4]
  - "ConfidenceBadge" # [file:4]
  - "DocChecklist" # [file:4]
  - "PreferencePill" # [file:4]
  - "RiskBanner" # [file:4]
  - "ScenarioTabs" # [file:4]
  - "StickyActionBar" # [file:4]
  - "InternalLinkGrid" # [file:4]

calculator_contract: # [file:4]
  calc_card_minimal_inputs: # [file:4]
    - "Origin selector (explicit)" # [file:4]
    - "Freight/insurance fields with anti-double-counting clarity" # [file:4]
    - "Incoterm selector (FOB/CIF/DDP…)" # [file:4]
    - "Importer type (VAT vendor vs non-vendor)" # [file:4]
    - "Quantity (optional unit measures)" # [file:4]

  hs_helper_inline_drawer: # [file:4]
    flow_must: # [file:4]
      - "User types description -> show 3-5 HS candidates with confidence + warnings." # [file:4]
      - "Ask 1-3 clarifying questions only when needed." # [file:4]
      - "User selects HS -> calculator reruns." # [file:4]

  confidence_ux: # [file:4]
    - "Always show confidence label near the summary." # [file:4]
    - "If confidence is low: show alternatives and optionally cost impact (slot must exist even if phased)." # [file:4]

output_contract: # [file:4]
  immediate_outputs_must_be_visible: # [file:4]
    - "Duty breakdown" # [file:4]
    - "VAT estimate" # [file:4]
    - "Total taxes" # [file:4]
    - "Landed cost per unit" # [file:4]
    - "Confidence / warning labels" # [file:4]

  why_drawer_auditability: # [file:4]
    required_for: ["Duty", "VAT", "fees"] # [file:4]
    must_include: # [file:4]
      - "Formula" # [file:4]
      - "Values used" # [file:4]
      - "Rates applied" # [file:4]
      - "Tariff version / effective date" # [file:4]
      - "Official source pointer (short; no long quotes)" # [file:4]

scenario_presets: # [file:4]
  ssr_requirement_hard: true # [file:4]
  presets_required: 3 # [file:4]
  preset_examples: ["R10k", "R50k", "R250k"] # [file:4]
  if_missing_tariff_or_rates: "keep NOINDEX" # [file:4]
  interaction_requirement: "Preset buttons apply values instantly and rerun calculation." # [file:4]

docs_and_next_steps: # [file:4]
  doc_checklist_grouping_required: # [file:4]
    - "Always required" # [file:4]
    - "Commonly required" # [file:4]
    - "If applicable" # [file:4]
  doc_item_requirements: # [file:4]
    - "Short 'why' tooltip supported." # [file:4]
    - "Zero-PDF mindset: structured guidance, not endless PDF links." # [file:4]

  next_steps_actions_block: # [file:4]
    must_include_examples: # [file:4]
      - "Compare with other origins" # [file:4]
      - "View HS code directory" # [file:4]
      - "See import checklist" # [file:4]

sticky_action_bar: # [file:4]
  required_actions_post_calc: # [file:4]
    - "Save" # [file:4]
    - "Export (PDF/CSV)" # [file:4]
    - "Compare scenarios" # [file:4]
    - "Watchlist (alert)" # [file:4]
  logged_out_behavior_non_negotiable: "Save/Export must prompt sign-in (not fail silently)." # [file:4]

internal_linking_contract: # [file:4]
  minimum_meaningful_internal_links_for_indexable_pages: 6 # [file:4]
  requirement_note: "Not footer spam; part of readiness/index gating." # [file:4]
  destinations_should_include_where_available: # [file:4]
    - "Same HS other origins" # [file:4]
    - "Same origin other related HS/clusters" # [file:4]
    - "HS classification tool/directory" # [file:4]
    - "Anti-dumping / risk information" # [file:4]
    - "Compare tool" # [file:4]

seo_metadata_and_publishing_controls: # [file:4]
  robots_and_sitemap_behavior: # [file:4]
    default_stance: "Everything starts NOINDEX." # [file:4]
    sitemap_rule: "NOINDEX pages must never appear in sitemap; INDEX pages must." # [file:4]

  index_gate_hard: # [file:4]
    indexable_only_if_all_true: # [file:4]
      - "Pre-filled calculator with valid HS mapping (or explicit HS)." # [file:4]
      - "Non-empty breakdown (duty + VAT minimum)." # [file:4]
      - ">=2 unique data-driven blocks (docs / preference / risk / computed scenarios)." # [file:4]
      - ">=6 internal links." # [file:4]
      - "Freshness metadata (tariff version + last updated)." # [file:4]

  auto_noindex_conditions: # [file:4]
    - "No HS candidates." # [file:4]
    - "Missing rate." # [file:4]
    - "Would output 'contact a broker' without numbers." # [file:4]
    - "Duplicates another page (canonicalize)." # [file:4]

  canonicalization_rules: # [file:4]
    - "Synonyms -> one canonical." # [file:4]
    - "If product+origin resolves to a single HS confidently, canonical may point to HS+origin page." # [file:4]

data_freshness_and_version_stamps: # [file:4]
  must_display: # [file:4]
    - "tariff_version_label" # [file:4]
    - "effective_date" # [file:4]
    - "last_updated_timestamp" # [file:4]
  fx_policy: # [file:4]
    when_live_fx_unavailable: "Show last cached rate + timestamp and allow manual override." # [file:4]

analytics: # [file:4]
  minimum_events: # [file:4]
    - "page_view" # [file:4]
    - "calc_started" # [file:4]
    - "calc_completed" # [file:4]
    - "hs_suggested" # [file:4]
    - "paywall_viewed" # [file:4]
    - "checkout_clicked" # [file:4]
    - "subscription_started" # [file:4]
  segmentation_required_by: # [file:4]
    - "page template" # [file:4]
    - "origin" # [file:4]
    - "product cluster" # [file:4]

performance_and_rendering: # [file:4]
  ssr_minimum_for_potentially_indexable_pages: # [file:4]
    - "H1/subtitle" # [file:4]
    - "CalcCard default values" # [file:4]
    - "Result preview with confidence" # [file:4]
    - "3 scenario preset outputs (computed)" # [file:4]
  progressive_enhancement: "Hydrate for interactivity, but SSR page must already be useful." # [file:4]

qa_and_tests: # [file:4]
  seo_snapshot_tests: # [file:4]
    verify_per_page_state: # [file:4]
      - "title/meta present" # [file:4]
      - "canonical correct" # [file:4]
      - "robots correct" # [file:4]
      - "structured blocks present" # [file:4]
  build_pass_tests: # [file:4]
    - "Pages without rates remain NOINDEX with explicit blocker reason." # [file:4]
  component_tests: # [file:4]
    - "CalcCard renders, validates, submits, displays breakdown." # [file:4]
    - "Drawers are accessible (keyboard)." # [file:4]

do_not_ship_violations: # [file:4]
  - "Loads as a blank shell until JS runs (no SSR outputs)." # [file:4]
  - "Lacks the 3 computed scenario presets." # [file:4]
  - "Hides core outputs behind login." # [file:4]
  - "Indexes pages that fail the index gate." # [file:4]
  - "Omits 'Why drawer' auditability for Duty/VAT lines." # [file:4]

implementation_checklist: # [file:4]
  items: # [file:4]
    - "Above-the-fold: Breadcrumbs -> H1 -> subtitle -> CalcCard -> result preview + ConfidenceBadge" # [file:4]
    - "Below: Breakdown(+Why) -> 3 presets -> docs -> preference -> risks -> internal links -> next actions" # [file:4]
    - "3 SSR scenario outputs (R10k/R50k/R250k) or NOINDEX" # [file:4]
    - "Index gating: all-true criteria + auto-NOINDEX + canonicalization" # [file:4]
    - "StickyActionBar with Save/Export/Compare/Watchlist; logged-out prompts sign-in" # [file:4]
    - "Doc checklist grouped + 'why' tooltips; zero-PDF mindset" # [file:4]
    - "Tariff version stamps + last updated shown" # [file:4]
    - "Events fired with stable IDs; segmented by template+origin+cluster" # [file:4]
