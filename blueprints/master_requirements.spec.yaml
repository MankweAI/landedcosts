# master_requirements.spec.yaml
# Source: master_requirements.md [file:3]

spec_version: "1.0" # [file:3]
title: "North Star MRF — LandedCost OS (SA-first, pSEO-powered SaaS)" # [file:3]

document: # [file:3]
  type: "Master Requirements File (MRF) — Source of Truth / North Star" # [file:3]
  status: "Active baseline (v1.0)" # [file:3]
  last_updated: "2026-02-14" # [file:3]
  product_name: "LandedCost OS" # [file:3]
  wedge_scope: "China -> South Africa (expand later)" # [file:3]

north_star: # [file:3]
  soul_statement: "Decision-grade landed cost + import-readiness report that answers in <30 seconds: real cost, what can go wrong, next steps, and likely profitability." # [file:3]
  positioning_rules: # [file:3]
    - "Not a calculator in spirit; a business decision tool." # [file:3]
    - "Each pSEO page is a complete standalone product page (decision report + interactive widgets)." # [file:3]
  time_to_value_seconds_lt: 30 # [file:3]

product_thesis: # [file:3]
  mission_query: "How much will it cost to import X from China into South Africa — and what do I need to do?" # [file:3]
  promise: "Collapse SARS/tariff complexity into duty/VAT/levies + landed cost per unit + (where available) preference + required documents." # [file:3]

constraints: # [file:3]
  acquisition_model: # [file:3]
    pseo_only_growth_engine: true # [file:3]
    disallow_outbound: true # [file:3]
    disallow_paid_ads: true # [file:3]
    money_pages_are_tools_not_articles: true # [file:3]
  integration_constraint: # [file:3]
    free_zero_cost_apis_only: true # [file:3]
    disallow_paid_data_feeds_for_core: true # [file:3]

saas_model: # [file:3]
  free_experience: # [file:3]
    must_be_complete_without_login_for_indexable_pages: true # [file:3]
    requirement: "User can run calculations and get decision-grade outputs without login." # [file:3]
  paywall: # [file:3]
    rule: "Only ask for signup/subscription once value is proven (exports/save/alerts/watchlists, etc.)." # [file:3]
    premium_examples: # [file:3]
      - "Save scenarios / workspace history" # [file:3]
      - "Export PDF/CSV" # [file:3]
      - "Watchlists + alerts (tariff/ITAC changes)" # [file:3]
      - "Multi-country (future)" # [file:3]
      - "API/embed (future)" # [file:3]

users_and_buyers: # [file:3]
  primary_users_sa_wedge: # [file:3]
    - "Importing SMEs / mid-market retailers, distributors, manufacturers" # [file:3]
    - "3PLs / freight forwarders / brokers needing customer-facing calculators/widgets" # [file:3]
    - "Cross-border ecom merchants importing into SA" # [file:3]
  economic_buyer: "Ops/logistics manager, CFO, or founder who owns import P&L and compliance risk." # [file:3]
  monetization_truth: "Users pay to avoid surprises/reduce risk and produce a reusable decision artifact (exports/history/audit), not just for a number." # [file:3]

success_outcomes: # [file:3]
  user_must_answer: # [file:3]
    - "Can I make money on this shipment?" # [file:3]
    - "What can go wrong, and what do I do next?" # [file:3]

core_capabilities: # [file:3]
  trust_core_tariff_brain: # [file:3]
    description: "Deterministic internal tariff engine producing auditable outputs." # [file:3]
    each_computed_output_must_expose: # [file:3]
      - "inputs" # [file:3]
      - "rule versions used" # [file:3]
      - "human-readable breakdown" # [file:3]
      - "references/citations list" # [file:3]
    versioning_mandatory: true # [file:3]
    versioning_reason: "Tariffs/VAT logic must be diffable and re-runnable." # [file:3]

  core_tools_ship_order: # [file:3]
    - id: "universal_landed_cost_calculator" # [file:3]
      description: "Inputs -> duty/VAT/levies + landed cost per unit." # [file:3]
      order: 1 # [file:3]
    - id: "hs_classification_helper" # [file:3]
      description: "Description -> candidate HS + confidence + warnings." # [file:3]
      order: 2 # [file:3]
    - id: "trade_preference_rebate_engine" # [file:3]
      description: "Later; can be partial initially." # [file:3]
      order: 3 # [file:3]
    - id: "scenario_comparator" # [file:3]
      description: "FOB vs CIF, quantity changes, freight mode." # [file:3]
      order: 4 # [file:3]

  importer_decision_primitives_must_appear_on_pages: # [file:3]
    - "Profitability / deal viability (margin, break-even, sensitivity)" # [file:3]
    - "Risk radar (classification uncertainty, anti-dumping flags, freight volatility)" # [file:3]
    - "Readiness plan (document checklist + next actions)" # [file:3]
    - "Cash impact (cash required at border, VAT vendor vs non-vendor treatment)" # [file:3]

pseo_page_system: # [file:3]
  philosophy: "Build an indexable entity library, not content pages." # [file:3]

  canonical_money_page_templates_minimum: # [file:3]
    - template: "product_cluster_page" # [file:3]
      pattern: "/import-duty-vat-landed-cost/{clusterSlug}/from/{originIso}/to/south-africa" # [file:3]
    - template: "hs_decision_page" # [file:3]
      pattern: "/import-duty-vat-landed-cost/hs/{hs6}/from/china/to/south-africa" # [file:3]
  future_templates_examples: # [file:3]
    - "compare scenarios pages" # [file:3]
    - "compliance alert pages" # [file:3]
    - "route/port pages" # [file:3]

  money_page_contract: # [file:3]
    must_include: # [file:3]
      - "Prefilled calculator (HS/product + origin)" # [file:3]
      - "Immediate outputs (duty, VAT, total taxes, landed cost per unit, confidence/warnings)" # [file:3]
      - "Checklist (docs), risk callouts, internal links" # [file:3]
      - "3 scenario presets (e.g., R10k/R50k/R250k or equivalent)" # [file:3]
    anti_spam_rationale: "Each page embeds pre-configured examples, doc checklist, risk callouts, and the calculator preloaded for that product/origin." # [file:3]

indexing_guardrails: # [file:3]
  hard_gates: # [file:3]
    indexable_only_if_all_true: # [file:3]
      - "Pre-filled calculator with valid HS mapping (or explicit HS)." # [file:3]
      - "Non-empty breakdown (duty + VAT minimum)." # [file:3]
      - ">=2 unique data-driven blocks (docs / preference / risk / computed scenarios)." # [file:3]
      - ">=6 internal links." # [file:3]
      - "Freshness metadata (tariff version + last updated)." # [file:3]
    auto_noindex_if_any_true: # [file:3]
      - "No HS candidates." # [file:3]
      - "Missing rates." # [file:3]
      - "Would output 'contact a broker' without numbers." # [file:3]
      - "Duplicates another page." # [file:3]

  computed_example_outputs_non_negotiable: # [file:3]
    presets_required: 3 # [file:3]
    rule: "If it can’t compute (missing tariff), keep NOINDEX." # [file:3]

  rollout_rule: # [file:3]
    phases: ["20-40", "100", "200"] # [file:3]
    constraint: "Only after passing readiness gates." # [file:3]

calculation_requirements: # [file:3]
  minimum_required_inputs_v1: # [file:3]
    - "Origin selector (explicit)" # [file:3]
    - "Incoterm selector (FOB/CIF/DDP etc.)" # [file:3]
    - "Freight & insurance (with anti-double-counting clarity)" # [file:3]
    - "Importer type (VAT-registered business vs non-vendor)" # [file:3]
    - "Quantity + unit measures (extend later for specific-duty lines)" # [file:3]

  scenario_presets_and_comparison_v1: # [file:3]
    - "Preset value bands (R10k/R50k/R250k) that recalc instantly." # [file:3]
    - "Simple compare flow (origin/incoterm) with deltas." # [file:3]

  explainability_why_drawer_mandatory: true # [file:3]
  why_drawer_must_include: # [file:3]
    - "formula" # [file:3]
    - "values used" # [file:3]
    - "rates applied" # [file:3]
    - "tariff version/effective date" # [file:3]
    - "source pointer" # [file:3]

data_sources_policy: # [file:3]
  primary_sources: # [file:3]
    - "SARS tariff/customs documents" # [file:3]
    - "VAT guidance" # [file:3]
  supplemental_sources: # [file:3]
    - "ITAC public notices (anti-dumping)" # [file:3]
    - "NRCS/SABS regs (manual curation)" # [file:3]

storage_model: # [file:3]
  db_primitives_minimum: # [file:3]
    - "calc_run (immutable): stores inputs/outputs + tariff_version + confidence label" # [file:3]
    - "saved_scenario" # [file:3]
    - "watch_item" # [file:3]
    - "subscription" # [file:3]
    - "page: index_status, canonical_slug, last_built_at, metrics" # [file:3]

observability: # [file:3]
  minimum_events: # [file:3]
    - "page_view" # [file:3]
    - "calc_started" # [file:3]
    - "calc_completed" # [file:3]
    - "hs_suggested" # [file:3]
    - "paywall_viewed" # [file:3]
    - "checkout_clicked" # [file:3]
    - "subscription_started" # [file:3]
  segmentation_required_by: # [file:3]
    - "page template" # [file:3]
    - "origin" # [file:3]
    - "product cluster" # [file:3]

quality_gates: # [file:3]
  accuracy_parity_test: # [file:3]
    deal_breaker: true # [file:3]
    requirement: "Real import scenarios must match expert/broker totals within a defined tolerance." # [file:3]
  determinism_test: # [file:3]
    requirement: "Same inputs + same tariff_version produce identical outputs; re-run old calcs must reproduce." # [file:3]

non_functional_requirements: # [file:3]
  performance: "Page usable fast; SSR renders meaningful outputs on load for indexable pages." # [file:3]
  accessibility: "Keyboard navigable, labeled inputs, non-color-only status indicators." # [file:3]
  safety: "Pages must never be indexed if missing data (robots/canonical/sitemap safety rails)." # [file:3]

out_of_scope_v1: # [file:3]
  - "Paid integrations / paid FX feeds" # [file:3]
  - "Full customs declaration filing software" # [file:3]
  - "Full global coverage beyond China->SA wedge" # [file:3]
  - "Deep automation of anti-dumping mapping (can be manual/partial initially)" # [file:3]

definition_of_done_v1: # [file:3]
  done_example_page: "Single indexable pSEO money page for a high-demand cluster (e.g., solar panels CN->ZA)." # [file:3]
  criteria: # [file:3]
    - "Renders 3 server-computed scenarios by default." # [file:3]
    - "Calc without login returns: duty, VAT, landed cost/unit, confidence label, decision-style summary." # [file:3]
    - "Contains >=2 unique data-driven blocks and >=6 internal links." # [file:3]
    - "Has freshness metadata (tariff version) and per-line 'Why drawer' explainability." # [file:3]
    - "Paywalled features limited to save/export/watchlist (not the core answer)." # [file:3]

glossary: # [file:3]
  money_page: "Indexable tool page targeting high-intent queries." # [file:3]
  cluster_page: "Product-category page that infers best HS candidates." # [file:3]
  hs_decision_page: "HS6-specific page for users who know classification." # [file:3]
  tariff_brain: "Versioned, deterministic rules engine producing auditable outputs." # [file:3]
  readiness_score: "Internal score used to decide INDEX vs NOINDEX publishing." # [file:3]
